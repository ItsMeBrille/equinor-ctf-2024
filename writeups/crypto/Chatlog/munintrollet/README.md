**Author: Zukane**

*So, I was walking a down the street eating a wiener when I came across this chatlog between a Mr. Rivest and a Mr. Adleman. They appear to be speaking in large numbers...*
*Can you help me uncover what they're talking about?*

##### Challenge overview

In this crypto challenge, we are given a **chat.log** textfile containing the following:

```
[22:10:25]      <Mr.Rivest>     Hi, I need to send you something. Can you send me your key?
[22:11:03]      <Mr.Adleman>    Sure, here: n=109773001979060500556771371722004589561407766472974181720301601504038097307183054327771414952722378616410690575654297998413723333283006388834687489519816814313970602740394095998728900971165525449666220812031401613319432338039749036919424709291358478655637030475075112370396605574403821950130705107292457546429 e=6251728305055461128215101113791542074487626873355761684912706796947820318045025894574010369655098754702916182673592159941529716341070091220295342244632166182377719507598162603755176681008223777597129409701832290624714334993812111228876927501848766224885363439534844304635205290155102644689388281018248057599
[22:11:47]      <Mr.Rivest>     69065966519105922162577567455261680573815854481710157074477507437933398566834762071577601999308205592512262422922008600362846112148013817314127895526875891430442404421013800492060589763419224572960632800381314756724351337523874069656512900871727433364755041357985429952615910953420906893665747562715489326060
[22:12:19]      <Mr.Adleman>    Hmm, I see... Thanks!  
```

Rivest and Adleman are two of the creators of the RSA encryption scheme. In the textfile, we are given the values $N$, $e$, and the ciphertext $c$.

```
N = 109773001979060500556771371722004589561407766472974181720301601504038097307183054327771414952722378616410690575654297998413723333283006388834687489519816814313970602740394095998728900971165525449666220812031401613319432338039749036919424709291358478655637030475075112370396605574403821950130705107292457546429
e = 6251728305055461128215101113791542074487626873355761684912706796947820318045025894574010369655098754702916182673592159941529716341070091220295342244632166182377719507598162603755176681008223777597129409701832290624714334993812111228876927501848766224885363439534844304635205290155102644689388281018248057599
c = 69065966519105922162577567455261680573815854481710157074477507437933398566834762071577601999308205592512262422922008600362846112148013817314127895526875891430442404421013800492060589763419224572960632800381314756724351337523874069656512900871727433364755041357985429952615910953420906893665747562715489326060
```

What stands out is the abnormally large value of $e$. This can often indicate that the encryption is vulnerable to a wiener attack or a boneh-durfee attack. These attacks can break the encryption if the value of the private key $d$  is relatively small. The bound for wiener attack is $N^{0.25}$ and for the boneh-durfee attack it is $N^{0.292}$.  The reason a large $e$ can indicate that these attacks are relevant is because when creating a challenge, it is simple to implement by just doing $d = N^{0.2}$ or for any other small exponent, and then finding the inverse of $d \mod \varphi$ which is usually a large value. Considering the challenge description mentions eating a *wiener*, this is likely the case. 

##### Solution

While the general implementations of the wiener attack or boneh-durfee aren't too complex, it is easier to just utilize the RsaCtfTool to solve this challenge. 

```
python3 ~/tools/RsaCtfTool/RsaCtfTool.py -n 109773001979060500556771371722004589561407766472974181720301601504038097307183054327771414952722378616410690575654297998413723333283006388834687489519816814313970602740394095998728900971165525449666220812031401613319432338039749036919424709291358478655637030475075112370396605574403821950130705107292457546429 -e 6251728305055461128215101113791542074487626873355761684912706796947820318045025894574010369655098754702916182673592159941529716341070091220295342244632166182377719507598162603755176681008223777597129409701832290624714334993812111228876927501848766224885363439534844304635205290155102644689388281018248057599 --decrypt 69065966519105922162577567455261680573815854481710157074477507437933398566834762071577601999308205592512262422922008600362846112148013817314127895526875891430442404421013800492060589763419224572960632800381314756724351337523874069656512900871727433364755041357985429952615910953420906893665747562715489326060 --attack boneh_durfee
```

This gives us the decrypted message $m$, which is the flag:

```
utf-8 : EPT{Shamir_is_up_2_something}
```
